# Rotape 사용자 시나리오

## 📱 사용자 (참가자) 시나리오

### 1. 로그인 및 초기 설정

#### 1.1 첫 방문 (신규 사용자)
1. **메인 페이지 (`/`)** 접속
   - 서비스 소개 확인
   - "Google로 로그인" 버튼 클릭
   - 약관 동의 모달 표시
   - 약관 동의 후 자동으로 사용자 계정 생성

2. **자동 리다이렉트**
   - 로그인 성공 시 → `/participant/events` (행사 리스트 페이지)로 이동

#### 1.2 재방문 (기존 사용자)
1. **메인 페이지 (`/`)** 접속
   - 이미 로그인된 경우 자동으로 `/participant/events`로 이동

---

### 2. 행사 신청

#### 2.1 행사 리스트 확인 (`/participant/events`)
- 모든 행사 목록 확인
  - 행사 제목
  - 일시
  - 장소
  - 최대 인원
- 각 행사별 지원 상태 확인
  - **신청 안 함**: "행사 신청하기" 버튼 표시
  - **심사 중**: "심사 중" 배지 표시
  - **승인됨**: "승인됨" 배지 표시
  - **거절됨**: "거절됨" 배지 표시

#### 2.2 행사 신청하기
1. **"행사 신청하기" 버튼 클릭**
   - 자동으로 `/participant/application?eventId={eventId}`로 이동

2. **지원서 작성 (`/participant/application`)**
   - **기본 정보 입력**
     - 이름
     - 성별 (남성/여성)
     - 생년 (나이 자동 계산)
     - 키 (cm)
     - 직업
   - **사진 업로드** (3장 필수)
     - 미리보기 기능 제공
     - 각 사진 변경 가능
   - **자기소개**
     - 나를 한 줄로 소개
     - 이상형 한 줄
     - 어떤 연애를 하고 싶은가요?
   - **사랑의 언어** (1~5순위 선택)
     - 행동, 선물, 언어, 시간, 스킨십 중 선택
     - 선택 순서대로 순위 결정
   - **제출하기** 버튼 클릭
     - 사진 업로드 → Firebase Storage
     - 사용자 정보 업데이트 → Firestore `users` 컬렉션
     - 지원서 생성 → Firestore `applications` 컬렉션 (문서 ID: `{uid}_{eventId}`)
     - 제출 성공 시 → `/participant/events`로 이동

---

### 3. 지원서 상태 확인

#### 3.1 행사 리스트에서 상태 확인
- `/participant/events` 페이지에서 각 행사별 지원 상태 확인
  - **심사 중**: 운영자가 아직 검토 중
  - **승인됨**: 행사 참가 확정
  - **거절됨**: 이번 행사 참가 불가

#### 3.2 마이페이지에서 확인 (`/participant/profile/my`)
- **내 정보** 섹션
  - 이름, 성별, 생년월일, 나이 표시
- **내 지원서** 섹션
  - 작성한 모든 지원서 목록 표시
  - 각 지원서별 정보:
    - 행사 제목 (eventId가 있는 경우)
    - 지원 상태 (심사 중/승인됨/거절됨)
    - 직업, 키
    - 자기소개
    - 첫 번째 사진 썸네일
    - 작성일
  - 지원서 클릭 시 상세 정보 모달 표시
    - 모든 사진 확인
    - 전체 지원서 내용 확인

---

### 4. 네비게이션

#### 4.1 모바일 환경
- **상단 TopBar**: Rotape 로고만 표시
- **하단 네비게이션**:
  - 행사 (행사 리스트)
  - 마이페이지 (내 정보 및 지원서)
  - 로그아웃

#### 4.2 데스크톱 환경
- **상단 네비게이션**:
  - Rotape 로고
  - 행사
  - 마이페이지
  - 로그아웃

---

## 👨‍💼 운영자 시나리오

### 1. 로그인

#### 1.1 운영자 로그인 (`/adminLogin`)
1. **운영자 로그인 페이지 접속**
   - 운영자 키 입력 (환경 변수: `NEXT_PUBLIC_ADMIN_KEY` 또는 기본값: `admin1234`)
   - "운영자로 로그인" 버튼 클릭
   - 운영자 키 검증
   - 로그인 성공 시 → `/admin` (운영자 대시보드)로 이동

#### 1.2 재방문
- 이미 로그인된 경우 자동으로 `/admin`으로 이동

---

### 2. 행사 관리

#### 2.1 행사 대시보드 (`/admin`)
- **행사 리스트** 확인
  - 모든 행사 카드 형태로 표시
  - 각 행사별 정보:
    - 행사 제목
    - 일시
    - 장소
    - 최대 인원
  - 행사 카드 클릭 → 해당 행사의 지원자 리스트 페이지로 이동

- **행사 생성**
  - "+ 행사 생성" 버튼 클릭 → `/admin/event`로 이동

#### 2.2 행사 생성 (`/admin/event`)
- **행사 정보 입력**
  - 행사 제목
  - 행사 일시 (datetime-local)
  - 행사 장소
  - 인트로 시간
  - 1부 시간
  - 쉬는 시간
  - 2부 시간
  - 최대 참가자 수 (10~30명)
- **"행사 생성" 버튼 클릭**
  - Firestore `events` 컬렉션에 행사 생성
  - 생성 성공 시 행사 리스트에 추가됨

#### 2.3 행사 상세 및 지원자 관리 (`/admin/event/[eventId]`)
- **행사 정보 표시**
  - 행사 제목
  - 일시
  - 장소
  - 최대 인원

- **지원자 리스트**
  - 해당 행사에 지원한 모든 지원자 표시
  - **필터 기능**
    - 이름/직업 검색
    - 상태 필터 (전체/심사 중/승인됨/거절됨)
    - 성별 필터 (전체/남성/여성)
  - **지원자 카드**
    - 이름, 성별, 나이, 직업
    - 지원 상태
    - **심사 중** 상태인 경우:
      - "승인" 버튼
      - "거절" 버튼
    - 지원자 카드 클릭 → 상세 정보 모달 표시

- **지원서 상세 모달**
  - 모든 지원서 정보 표시
  - 사진 3장 표시
    - 마우스 hover 시 "크게 보기", "다운로드" 버튼 표시
  - 승인/거절 버튼 (심사 중인 경우)
  - 닫기 버튼

---

### 3. 네비게이션

#### 3.1 모바일 환경
- **상단 TopBar**: Rotape 로고만 표시
- **하단 네비게이션**:
  - 행사관리 (대시보드)
  - 매칭
  - 로테이션
  - 로그아웃

#### 3.2 데스크톱 환경
- **상단 네비게이션**:
  - Rotape 로고
  - 행사관리
  - 매칭
  - 로테이션
  - 로그아웃

---

## 🔄 주요 플로우 요약

### 사용자 플로우
```
메인 페이지 (/) 
  → Google 로그인 
  → 약관 동의 
  → 행사 리스트 (/participant/events)
  → 행사 신청하기 클릭 
  → 지원서 작성 (/participant/application?eventId=xxx)
  → 제출 완료 
  → 행사 리스트로 복귀
  → 마이페이지에서 지원서 확인 (/participant/profile/my)
```

### 운영자 플로우
```
운영자 로그인 (/adminLogin)
  → 운영자 키 입력
  → 행사 관리 대시보드 (/admin)
  → 행사 생성 (/admin/event) 또는
  → 행사 상세 클릭 (/admin/event/[eventId])
  → 지원자 리스트 확인 및 승인/거절
```

---

## 📋 주요 기능 상태

### ✅ 구현 완료
- [x] 사용자 Google 로그인
- [x] 운영자 키 기반 로그인
- [x] 지원서 작성 (행사별)
- [x] 행사 리스트 조회
- [x] 행사별 지원자 관리
- [x] 지원서 승인/거절
- [x] 마이페이지 (내 지원서 확인)
- [x] 반응형 네비게이션 (모바일/데스크톱)
- [x] 모바일 TopBar

### 🚧 미구현 (페이지는 존재하나 기능 미완성)
- [ ] 행사 당일 대시보드 (`/participant/event`)
- [ ] 로테이션 선택 (`/participant/rotation`)
- [ ] 매칭 결과 (`/participant/results`)
- [ ] 운영자 로테이션 진행 (`/admin/rotation`)
- [ ] 운영자 매칭 결과 관리 (`/admin/matching`)

---

## 🔐 인증 및 권한

### 사용자 인증
- **방법**: Google 소셜 로그인
- **저장 위치**: Firebase Authentication
- **사용자 정보**: Firestore `users` 컬렉션
- **권한**: `isAdmin: false`

### 운영자 인증
- **방법**: 운영자 키 기반 이메일/비밀번호 로그인
- **저장 위치**: Firebase Authentication
- **사용자 정보**: Firestore `users` 컬렉션
- **권한**: `isAdmin: true`

---

## 📊 데이터 구조

### 주요 컬렉션
- **users**: 사용자 기본 정보 (이름, 성별, 생년월일, 나이, isAdmin)
- **events**: 행사 정보 (제목, 일시, 장소, 타임라인, 최대 인원)
- **applications**: 지원서 정보 (행사별, `{uid}_{eventId}` 형태의 문서 ID)
  - 상태: `pending` | `approved` | `rejected`
- **profiles**: 승인된 참가자 프로필 (행사별)
- **rounds**: 로테이션 라운드 정보
- **likes**: 로테이션 선택 결과
- **matches**: 최종 매칭 결과

